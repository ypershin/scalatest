package examples

object test2 {

  // val lst = List(("A", 1,1),("A",1,2),("B",2,3),("B",2,4))

  val lst = List(("A", 1), ("A", 1), ("B", 2), ("B", 2))
                                                  //> lst  : List[(String, Int)] = List((A,1), (A,1), (B,2), (B,2))

  //  lst groupBy (p => (p._1,p._2)) map {
  //  	case(k,v) => (p._1,p._2, (v map (_._3) sum))
  //  }

  //	lst groupBy (p => p._1) map {
  //		case(k,v) => (k._1, (v map (_._2) sum))
  //	}
  
  

  val in = List(("PO123", "P001", "Item 1", 10, 10), ("PO123", "P001", "Item 1", 10, 10),
    ("PO123", "P002", "Item 2", 30, 30), ("PO123", "P002", "Item 2", 10, 10))
                                                  //> in  : List[(String, String, String, Int, Int)] = List((PO123,P001,Item 1,10,
                                                  //| 10), (PO123,P001,Item 1,10,10), (PO123,P002,Item 2,30,30), (PO123,P002,Item 
                                                  //| 2,10,10))

  val lst2 = in groupBy (p => (p._1, p._2, p._3)) map {
    case (k, v) =>
      (k._1, k._2, k._3, (v map (_._4) sum), (v map (_._5) sum))
  }                                               //> lst2  : scala.collection.immutable.Iterable[(String, String, String, Int, In
                                                  //| t)] = List((PO123,P001,Item 1,20,20), (PO123,P002,Item 2,40,40))
	println(lst2.mkString("\n"))              //> (PO123,P001,Item 1,20,20)
                                                  //| (PO123,P002,Item 2,40,40)

  val ls = List(("0010000011136","2014/07/01","OFF",3566.63,115.75002346134977),
  ("0010000011136","2014/07/01","ON",5126.0,202.09046566763018),
  ("0010000011136","2014/07/01","OFF",1117.69,39.936296802949684),
  ("0010000011136","2014/07/01","OFF",3720.25,125.6432784528441),
  ("0010000011136","2014/07/01","ON",8016.48,311.9576248260375),
  ("0010000011136","2014/07/01","OFF",1459.34,51.42375562918143),
  ("0010000011136","2014/07/01","ON",7875.92,284.5921383797838),
  ("0010000011136","2014/07/01","OFF",1507.86,49.4503316522012),
  ("0010000011136","2014/07/01","ON",7160.94,281.43863760207745),
  ("0010000011136","2014/07/01","OFF",1941.26,70.87310163594731),
  ("0010000011136","2014/07/01","ON",5352.25,200.07746212239599),
  ("0010000011136","2014/07/01","OFF",1143.51,39.13275886660904))
                                                  //> ls  : List[(String, String, String, Double, Double)] = List((0010000011136,
                                                  //| 2014/07/01,OFF,3566.63,115.75002346134977), (0010000011136,2014/07/01,ON,51
                                                  //| 26.0,202.09046566763018), (0010000011136,2014/07/01,OFF,1117.69,39.93629680
                                                  //| 2949684), (0010000011136,2014/07/01,OFF,3720.25,125.6432784528441), (001000
                                                  //| 0011136,2014/07/01,ON,8016.48,311.9576248260375), (0010000011136,2014/07/01
                                                  //| ,OFF,1459.34,51.42375562918143), (0010000011136,2014/07/01,ON,7875.92,284.5
                                                  //| 921383797838), (0010000011136,2014/07/01,OFF,1507.86,49.4503316522012), (00
                                                  //| 10000011136,2014/07/01,ON,7160.94,281.43863760207745), (0010000011136,2014/
                                                  //| 07/01,OFF,1941.26,70.87310163594731), (0010000011136,2014/07/01,ON,5352.25,
                                                  //| 200.07746212239599), (0010000011136,2014/07/01,OFF,1143.51,39.1327588666090
                                                  //| 4))
  
  ls groupBy (p => (p._1,p._2,p._3)) map {
  case(k, v) =>
   (k._1, k._2, k._3, (v map (_._4) sum ), (v map (_._5) sum) )
  }                                               //> res0: scala.collection.immutable.Iterable[(String, String, String, Double, 
                                                  //| Double)] = List((0010000011136,2014/07/01,ON,33531.59,1280.1563285979248), 
                                                  //| (0010000011136,2014/07/01,OFF,14456.54,492.2095465010825))
  
  for(l <- ls) println(l._1 + "\t" + l._2)        //> 0010000011136	2014/07/01
                                                  //| 0010000011136	2014/07/01
                                                  //| 0010000011136	2014/07/01
                                                  //| 0010000011136	2014/07/01
                                                  //| 0010000011136	2014/07/01
                                                  //| 0010000011136	2014/07/01
                                                  //| 0010000011136	2014/07/01
                                                  //| 0010000011136	2014/07/01
                                                  //| 0010000011136	2014/07/01
                                                  //| 0010000011136	2014/07/01
                                                  //| 0010000011136	2014/07/01
                                                  //| 0010000011136	2014/07/01
  
  println(ls.mkString("\n"))                      //> (0010000011136,2014/07/01,OFF,3566.63,115.75002346134977)
                                                  //| (0010000011136,2014/07/01,ON,5126.0,202.09046566763018)
                                                  //| (0010000011136,2014/07/01,OFF,1117.69,39.936296802949684)
                                                  //| (0010000011136,2014/07/01,OFF,3720.25,125.6432784528441)
                                                  //| (0010000011136,2014/07/01,ON,8016.48,311.9576248260375)
                                                  //| (0010000011136,2014/07/01,OFF,1459.34,51.42375562918143)
                                                  //| (0010000011136,2014/07/01,ON,7875.92,284.5921383797838)
                                                  //| (0010000011136,2014/07/01,OFF,1507.86,49.4503316522012)
                                                  //| (0010000011136,2014/07/01,ON,7160.94,281.43863760207745)
                                                  //| (0010000011136,2014/07/01,OFF,1941.26,70.87310163594731)
                                                  //| (0010000011136,2014/07/01,ON,5352.25,200.07746212239599)
                                                  //| (0010000011136,2014/07/01,OFF,1143.51,39.13275886660904)
  
  
  
  
  
    


}